# fraud_historical_research

Мне предлагалось сделать ресерч.

Я попробовала
- построить графики распределения по amount
- поссмотреть корреляцию с категоритальными / числовыми данными
- построить катбуст чтобы дополнительно убедиться в важных признаках

Все результаты - в юпитер ноутбуке

### Часть 1
Можно заметить как среднее и медиана средней суммы транзакций заметно отличаются => есть выбросы с огромными суммами
Также строя распределеня по сумме транзакции (мошеннической или нет) по городам результат ничего не показал. Вернее кажется что если города не входят в топ мошеннических то распределение очень похожи - нормальные транзакции имеют пик в сумме около 500 и дальше стремительно падают в то время как мошеннические стабильны по сумме не считая начальных значений где идет больший процент.
На распределении по Unknown City которая кстати топ по мошенническим видно что отзумившись у нас практически линейное падение плотности до порога в ~70.000 где далее более резкое снижение. Возможно у банковских систем есть банальные блокировки на этот порог или что-то вроде этого.
Также при переводе сумм в USD практически ничего не изменилось 

Хотя я погуглила - вроде ограничение $10,000

Дополнительно я посчитала проценты мошеннических по некоторым категориальным признакам и пришла к выводу что vendor_category, card_type ни на что не влияют, но страны можно разделить на топ-4 по мошенничеству и все остальные где в каждой группе распределение более менее одинаково.

### Часть 2
Рассматриваем корреляции признаков (с `is_fraud`).
1. Я добавила явные признаки час, день недели, часть дня (ночь).
2. Я разбила колонки на категориальные (`'vendor_category', 'vendor_type', 'country', 'city_size', 'card_type', 'channel'`) для которых применила one hot и посчитала корреляцию Пирсона
3. Для числовых (`'amount', 'hour', 'day_of_week', 'last_hour_num_transactions', 'last_hour_total_amount' 'last_hour_unique_merchants', 'last_hour_unique_countries', 'last_hour_max_single_amount'`) аналогично

В итоге получилась значимая корреляция таргета c признаками 'is_outside_home_country', 'is_card_present', 'channel', 'is_night', 'hour', 'amount', `country`, 'city_size_medium'

Занятно что видимо мошеннические операции любят проводить ночью -_-

### Часть 3
Для дальнейшего исследования завивимостей я решила завести катбуст.
Не без проблем с преобразованиями типов и заполнения промежуточных переменных я пришла к обучению на признаках
'amount', 'hour', 'day_of_week', 'is_weekend', 'is_night', 'is_card_present', 'is_outside_home_country', 'is_high_risk_vendor','vendor_category', 'vendor_type', 'country', 'city_size', 'card_type', 'channel'

За 500 итераций мы получили неплохие результаты - F1=0.95
| Class   | Precision | Recall | F1-Score | Support  |
|---------|-----------|--------|----------|----------|
| False   | 0.98      | 0.99   | 0.99     | 1,796,714|
| True    | 0.98      | 0.92   | 0.95     | 448,416  |
| **Total Metrics** |          |        |          |          |
| Accuracy         |           |        | 0.98     | 2,245,130|
| Macro Avg       | 0.98      | 0.96   | 0.97     | 2,245,130|
| Weighted Avg    | 0.98      | 0.98   | 0.98     | 2,245,130|

По важным признакам получилось так:

| Feature                   | Importance |
|---------------------------|------------|
| amount                    | 30.23      |
| is_card_present           | 28.26      |
| country                   | 12.66      |
| is_outside_home_country   | 11.21      |
| channel                   | 7.49       |
| hour                      | 3.47       |
| vendor_type               | 3.34       |
| card_type                 | 2.18       |

Все же vendor_type вошел в любимые признаки катбуста хоть и слабо.